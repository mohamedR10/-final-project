<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
                <script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
                <script  defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
                <script src="/path/to/bootstrap/js/bootstrap.min.js"></script>
                <link defer href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
                <script defer src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.1/js/bootstrap.min.js" integrity="sha512-3dZ9wIrMMij8rOH7X3kLfXAzwtcHpuYpEgQg1OA4QAob1e81H8ntUQmQm3pBudqIoySO5j0tHN4ENzA6+n2r4w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
                <link rel="stylesheet" href="/bootstrap.min.css">
                <link rel="stylesheet" href="style.css">
        
        <title>Document</title>
    </head>
<body>

  <!--  add Post Button  -->
 
    
    <!-- creat post modal -->
    <div class="modal fade" id="creat-post-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Creat New post</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label" >Title</label>
                <input type="text" class="form-control" id="creat-post-title-input" value="Yarob44">
              </div>
              <div class="mb-3">
    
                <textarea name="" id="post-text-area" cols="30" rows="10"></textarea>
              </div>
    
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label" >Image</label>
                <input type="file" class="form-control" id="post-image-input" value="Yarob44">
              </div>
            
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >Close</button>
            <button type="button" class="btn btn-primary"onclick="creatNewPostClick()">post</button>
          </div>
        </div>
      </div>
    </div>
    
      <!--  add Post Button  -->
        
        <!--modal -->
      <!-- Button trigger modal -->
    
      
      <!-- Modal -->
     
    <div class="modal fade" id="login-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Login</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="recipient-name" class="col-form-label" >User Name:</label>
                <input type="text" class="form-control" id="username-input" value="Yarob44">
              </div>
              <div class="mb-3">
                <label for="message-text" class="col-form-label">Password:</label>
                <input type="password" class="form-control" id="username-password" value="123456">
               </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >Close</button>
            <button type="button" class="btn btn-primary"onclick="loginButtonClicked()">Login</button>
          </div>
        </div>
      </div>
    </div>
        <!--modal -->
    
        <!-- register modal -->
        <div class="modal fade" id="register-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="exampleModalLabel">Register New user </h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <form>
    
    
    
                    <div class="mb-3">
                      <label for="recipient-name" class="col-form-label" > Profile Image</label>
                      <input type="file" class="form-control" id="register-image-input" value="Yarob44">
                    </div>
    
                    <div class="mb-3">
                        <label for="recipient-name" class="col-form-label" > Name:</label>
                        <input type="text" class="form-control" id="register-name-input" value="Yarob44">
                      </div>
                    <div class="mb-3">
                      <label for="recipient-name" class="col-form-label" >User Name:</label>
                      <input type="text" class="form-control" id="register-username-input" value="Yarob44">
                    </div>
                    <div class="mb-3">
                      <label for="message-text" class="col-form-label">Password:</label>
                      <input type="password" class="form-control" id="register-username-password" value="123456">
                     </div>
                  </form>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >Close</button>
                  <button type="button" class="btn btn-primary"onclick="registerButtonClicked()">register</button>
                </div>
              </div>
            </div>
          </div>
        <!-- register modal -->
    
    
        <!-- alert  -->
        <div id="success-alert" class="show fade"></div>

<!-- nav bar  --> 
        <div class="container  cont ">
            <div class="d-flex  justify-content-center">
                <div class="col-9">
                        <nav class="navbar navbar-expand-lg bg-body-tertiary shadow rounded">
                            <div class="container-fluid">
                              <a class="navbar-brand" href="#"></a>
                              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                              </button>
                              <div class="collapse navbar-collapse" id="navbarNavDropdown">
                                <ul class="navbar-nav">
                                  <li class="nav-item"> 
                                    <a class="nav-link active" aria-current="page" href="index.html">Home</a>
                                  </li>
                                  <li class="nav-item">
                                    <a class="nav-link" href="#">profile</a>
                                  </li>
                                  <li class="nav-item">
                                    <a class="nav-link" href="#">Pricing</a>
                                  </li>
                                  
                                   
                                  </li>
                                </ul>
                              </div>
                            
                    
                            <div id="option-btns">
                              
            
                              <img src="/user.jpg" class="rounded-circle" id="user-img" alt="">
                              <b id="nav-username">@mohamed Ramadan</b>
                                <button id="login-btn" type="button"  data-bs-toggle="modal" data-bs-target="#login-modal"  class="btn btn-outline-success mx-2"  >login</button>
                              
                                <button  onclick="logOut()" id="logout-btn" type="button" class="btn btn-outline-success mx-2">LogOut</button>
                              
                                <button id="register-btn" type="button"  data-bs-toggle="modal" data-bs-target="#register-modal" class="btn btn-outline-success" >register</button>
                            </div>   
                        </div>  
                        </nav>
                </div>
            </div>
                <!-- nav bar -->
            
                </div>


                <!-- main Contnet -->
                <div >
                <div class="container col-9"style="1000px ">
                <!-- user post  -->
                <div class="row-mt-5 d-flex justify-content-center">
                    <div class="col-lg-9"  id="post">
                        <h1>
                            <div id="username-span">
                                yaroob
                            </div>
                        </h1>
                    </div>

                </div>
                <!-- post raw -->

               <div  id="single" >
                 <div class="card shadow">
                     <div class="card-header">
                      <img src="/user.jpg" alt="" class="">
                      <p id="">@ mohamed Ramadan</p>
                     </div>
                     <div class="card-body">
                         <img src="/bird-8155768_1280.jpg" alt="">
                
                         <h6> since 2 min</h6>
                         <h6>hello world</h6>
                         <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Maxime autem nisi adipisci aspernatur velit eligendi, expedita iure vitae maiores rem.</p>
                         <hr>
                         <div>
                             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pen-fill" viewBox="0 0 16 16">
                                 <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001z"/>
                               </svg>                        <span>(3) Comments
                
                                 <span><button class="btn btn-sm rounded-5" style="background-color: gray; color: aliceblue;">policy</button> </span>
                               </span>
                         </div>
                
                
                
                     </div>

                     
                     


                     <!-- comments -->
                    <div id="comments">
                      <!-- comment -->
                       <div class="p-3"  style="background-color: aliceblue;">
                        
                       <div>
                         <img src="/user.jpg" class="rounded" style="width: 40px; height: 40px;" alt="">
                         <b>@ mohamed Ramadan</b>
                       </div>
                      
                       <!-- comments body  -->
                       <div> Lorem ipsum dolor sit amet consectetur adipisicing elit.</div>
                       <!-- comments body  -->
                      
                       </div>
                       <!-- comment -->
                    </div>
                     <!-- comments -->
                   </div> 
                
                 </div>
               </div >
                <!-- post raw -->
                
                </div>


    </body>
    <script src="/bootstrap.js"></script>

    <!-- <script src="/main.js"></script> -->





    <script>
//             function setupUi (){

// const loginButton = document.getElementById("login-btn")
// const logOut =document.getElementById("logout-btn")
// const registerButtoon = document.getElementById("register-btn")
// const token = localStorage.getItem("token")
// const addButton = document.getElementById("add-btn")


// if (token == null){

//     if(addButton != null){
//         addButton.style.display="none"



//     }
//     loginButton.style.visibility="visible"

//     logOut.style.display="none"
//     registerButtoon.style.visibility="visible"
//     document.getElementById("nav-username").innerHTML=""
//     document.getElementById("user-img").style.display="none"




// }else{

//     if(addButton != null){

//         addButton.style.display="block"

//     }

//     registerButtoon.style.visibility="hidden"
//     logOut.style.visibility="visible"
//     loginButton.style.visibility="hidden"
//     logOut.style.setProperty("background-color","red","important")
//     const user = getCurrentUser()
//     document.getElementById("nav-username").innerHTML=user.username
//         document.getElementById("user-img").src =user.profile_image


  






// }
// getPosts()
// } 
//     setupUi()


const  baseUrl = "https://tarmeezacademy.com/api/v1"


        console.log(window.location.search)
        const urlparams = new URLSearchParams(window.location.search)
        console.log(urlparams)
       const id =  urlparams.get("postid")
       console.log(id)
       function getpost(){

axios.get(`${baseUrl}/posts/${id}`)
.then(Response => {

    const post = Response.data.data
    const commentsCount = post.comments_count
    const Comments = post.comments
    const author = post.author
    console.log(post)
    document.getElementById("username-span").innerHTML=author.username

let commentConnnents =""
for(comment of Comments){

  commentConnnents+=`
  <div class="p-3"  style="background-color: aliceblue;">
                        
                        <div>
                          <img src="${comment.author.profile_image}" class="rounded" style="width: 40px; height: 40px;" alt="">
                          <b>${comment.author.username}</b>
                        </div>
                       
                        <!-- comments body  -->
                        <div> ${comment.body}</div>
                        <!-- comments body  -->
                       
                        </div>

                       
  
  
  `
}
    const postContent =`
    
    <div class="card shadow">
            <div class="card-header">
             <img src="${author.profile_image}"" class="">
             <p id="">${author.username}</p>
            </div>
            <div class="card-body">
                <img src="${post.image}" alt="">

                <h6> ${post.created_at}</h6>
                <h6>${post.title}</h6>
                <p>${post.body}</p>
                <hr>
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pen-fill" viewBox="0 0 16 16">
                        <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001z"/>
                      </svg>                        <span>${commentsCount} Comments

                        <span><button class="btn btn-sm rounded-5" style="background-color: gray; color: aliceblue;">policy</button> </span>
                      </span>
                </div>



            </div>
          </div> 
          <div id="comments" >${commentConnnents}</div>

        </div>

        <div class="input-group mb-3" id="add-comment-div">
                          <input  id="comment-input" type="text" placeholder="add your comment" class="form-control">
                          <button? class="btn btn-outline-primary" type="button" onClick="creatCommentClick()">Send</button?
                          
                          </div>
    
    
    `
    document.getElementById("single").innerHTML=postContent


})


}
getpost()


function creatCommentClick(){
  let commentBody = document.getElementById("comment-input").value
let params ={
  "body":commentBody
}

let url= `${baseUrl}/posts/${id}/comments`
let token = localStorage.getItem("token")
console.log(token)


axios.post(url,params,{
headers:{
  "authorization":`Bearer ${token}`
}

}).then(respons =>{
  console.log(respons.data)
  showAlert("comment add Succesfuly","success")


  getpost()
}

).catch(error => {
  console.log(error)
  const erroMessage = error.response.data.message
  showAlert(erroMessage,"danger")
})
}







function showAlert(customMessage,type){

// bootstrap alert 
const alertPlaceholder = document.getElementById('success-alert')
const appendAlert = (message, type) => {
  const wrapper = document.createElement('div')
  wrapper.innerHTML = [
    `<div class="alert alert-${type} alert-dismissible" role="alert">`,
    `   <div>${message}</div>`,
    '   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>',
    '</div>'
  ].join('')

  alertPlaceholder.append(wrapper)
}

    appendAlert(customMessage, type)
    // todo const myAlert = bootstrap.alert.getOrCreatinstance("#success-alert")
    //  todo myAlert.close()

    //todo setTimeout(()=>{

    //     const myAlert = bootstrap.alert.getOrCreatinstance("#success-alert")
    //     myAlert.close()
    // },3000)
}
    </script>

</html>